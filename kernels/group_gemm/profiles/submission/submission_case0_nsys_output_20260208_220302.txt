============================================================
NVFP4 Group GEMM Kernel Profiler
============================================================
Device: NVIDIA B200
CUDA Version: 12.8

Profiling: 8 groups, small M, large N/K
Groups: 8
Problem sizes:
  Group 0: M=80, N=4096, K=7168
  Group 1: M=176, N=4096, K=7168
  Group 2: M=128, N=4096, K=7168
  Group 3: M=72, N=4096, K=7168
  Group 4: M=64, N=4096, K=7168
  Group 5: M=248, N=4096, K=7168
  Group 6: M=96, N=4096, K=7168
  Group 7: M=160, N=4096, K=7168
Total FLOPs: 60.13 GFLOPs

Using SUBMISSION kernel

Generating input data...
Input generation complete.

Running 2 warmup iteration(s)...
Warmup complete.

==================================================
RUNNING PROFILED KERNEL CALL (submission)
==================================================
Kernel execution complete.
==================================================

Done!
Collecting data...
Generating '/tmp/nsys-report-6147.qdstrm'
[1/8] [0%                          ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [0%                          ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [===23%                      ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [===24%                      ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [====25%                     ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [====26%                     ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [====27%                     ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [====28%                     ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [=====29%                    ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [=====30%                    ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [=======37%                  ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [=======38%                  ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [========40%                 ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [========41%                 ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [==========49%               ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [===========51%              ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [==================77%       ] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [========================100%] submission_case0_nsys_20260208_220302.nsys-rep[1/8] [========================100%] submission_case0_nsys_20260208_220302.nsys-rep
[2/8] [0%                          ] submission_case0_nsys_20260208_220302.sqlite[2/8] [1%                          ] submission_case0_nsys_20260208_220302.sqlite[2/8] [2%                          ] submission_case0_nsys_20260208_220302.sqlite[2/8] [3%                          ] submission_case0_nsys_20260208_220302.sqlite[2/8] [4%                          ] submission_case0_nsys_20260208_220302.sqlite[2/8] [5%                          ] submission_case0_nsys_20260208_220302.sqlite[2/8] [6%                          ] submission_case0_nsys_20260208_220302.sqlite[2/8] [7%                          ] submission_case0_nsys_20260208_220302.sqlite[2/8] [8%                          ] submission_case0_nsys_20260208_220302.sqlite[2/8] [9%                          ] submission_case0_nsys_20260208_220302.sqlite[2/8] [10%                         ] submission_case0_nsys_20260208_220302.sqlite[2/8] [11%                         ] submission_case0_nsys_20260208_220302.sqlite[2/8] [12%                         ] submission_case0_nsys_20260208_220302.sqlite[2/8] [13%                         ] submission_case0_nsys_20260208_220302.sqlite[2/8] [14%                         ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=15%                        ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=16%                        ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=17%                        ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==18%                       ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==19%                       ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==20%                       ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==21%                       ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===22%                      ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===23%                      ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===24%                      ] submission_case0_nsys_20260208_220302.sqlite[2/8] [====25%                     ] submission_case0_nsys_20260208_220302.sqlite[2/8] [====26%                     ] submission_case0_nsys_20260208_220302.sqlite[2/8] [====27%                     ] submission_case0_nsys_20260208_220302.sqlite[2/8] [====28%                     ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=====29%                    ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=====30%                    ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=====31%                    ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=====32%                    ] submission_case0_nsys_20260208_220302.sqlite[2/8] [======33%                   ] submission_case0_nsys_20260208_220302.sqlite[2/8] [======34%                   ] submission_case0_nsys_20260208_220302.sqlite[2/8] [======35%                   ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=======36%                  ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=======37%                  ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=======38%                  ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=======39%                  ] submission_case0_nsys_20260208_220302.sqlite[2/8] [========40%                 ] submission_case0_nsys_20260208_220302.sqlite[2/8] [========41%                 ] submission_case0_nsys_20260208_220302.sqlite[2/8] [========42%                 ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=========43%                ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=========44%                ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=========45%                ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=========46%                ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==========47%               ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==========48%               ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==========49%               ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===========50%              ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===========51%              ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===========52%              ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===========53%              ] submission_case0_nsys_20260208_220302.sqlite[2/8] [============54%             ] submission_case0_nsys_20260208_220302.sqlite[2/8] [============55%             ] submission_case0_nsys_20260208_220302.sqlite[2/8] [============56%             ] submission_case0_nsys_20260208_220302.sqlite[2/8] [============57%             ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=============58%            ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=============59%            ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=============60%            ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==============61%           ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==============62%           ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==============63%           ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==============64%           ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===============65%          ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===============66%          ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===============67%          ] submission_case0_nsys_20260208_220302.sqlite[2/8] [================68%         ] submission_case0_nsys_20260208_220302.sqlite[2/8] [================69%         ] submission_case0_nsys_20260208_220302.sqlite[2/8] [================70%         ] submission_case0_nsys_20260208_220302.sqlite[2/8] [================71%         ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=================72%        ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=================73%        ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=================74%        ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==================75%       ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==================76%       ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==================77%       ] submission_case0_nsys_20260208_220302.sqlite[2/8] [==================78%       ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===================79%      ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===================80%      ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===================81%      ] submission_case0_nsys_20260208_220302.sqlite[2/8] [===================82%      ] submission_case0_nsys_20260208_220302.sqlite[2/8] [====================83%     ] submission_case0_nsys_20260208_220302.sqlite[2/8] [====================84%     ] submission_case0_nsys_20260208_220302.sqlite[2/8] [====================85%     ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=====================86%    ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=====================87%    ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=====================88%    ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=====================89%    ] submission_case0_nsys_20260208_220302.sqlite[2/8] [======================90%   ] submission_case0_nsys_20260208_220302.sqlite[2/8] [======================91%   ] submission_case0_nsys_20260208_220302.sqlite[2/8] [======================92%   ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=======================93%  ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=======================94%  ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=======================95%  ] submission_case0_nsys_20260208_220302.sqlite[2/8] [=======================96%  ] submission_case0_nsys_20260208_220302.sqlite[2/8] [========================97% ] submission_case0_nsys_20260208_220302.sqlite[2/8] [========================98% ] submission_case0_nsys_20260208_220302.sqlite[2/8] [========================99% ] submission_case0_nsys_20260208_220302.sqlite[2/8] [========================100%] submission_case0_nsys_20260208_220302.sqlite[2/8] [========================100%] submission_case0_nsys_20260208_220302.sqlite
[3/8] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)   Style              Range            
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  -------  ----------------------------
    100.0          590,783          1  590,783.0  590,783.0   590,783   590,783          0.0  PushPop  :nvfp4_group_gemm_submission

[4/8] Executing 'osrt_sum' stats report

 Time (%)  Total Time (ns)  Num Calls     Avg (ns)         Med (ns)        Min (ns)       Max (ns)       StdDev (ns)             Name         
 --------  ---------------  ---------  ---------------  ---------------  -------------  -------------  ---------------  ----------------------
     27.9    4,851,411,769          1  4,851,411,769.0  4,851,411,769.0  4,851,411,769  4,851,411,769              0.0  pthread_join          
     27.9    4,847,258,556         20    242,362,927.8         54,553.5          1,821  4,792,170,361  1,070,970,098.9  futex                 
     27.6    4,790,912,670         10    479,091,267.0        297,785.5         63,229  4,788,342,516  1,514,116,567.5  epoll_wait            
     10.4    1,809,914,488         34     53,232,779.1     33,559,197.5          2,219    257,668,547     55,198,179.7  poll                  
      4.0      695,713,142         69     10,082,799.2      1,289,017.0        269,032    312,304,184     52,602,655.0  pthread_cond_wait     
      1.1      193,917,102        872        222,382.0          9,332.5          1,023     20,020,064      1,079,166.8  ioctl                 
      0.4       76,441,717      1,844         41,454.3          4,516.5          1,001      1,894,994        195,652.3  read                  
      0.2       34,439,900      3,435         10,026.2          3,183.0          1,004      4,090,595         81,450.4  open64                
      0.1       19,175,770        966         19,850.7         15,882.0          1,012        260,124         19,996.9  write                 
      0.1       16,979,500      5,372          3,160.7          1,429.0          1,000      2,146,020         40,594.4  stat64                
      0.0        5,144,105          1      5,144,105.0      5,144,105.0      5,144,105      5,144,105              0.0  nanosleep             
      0.0        4,748,782         35        135,679.5         41,291.0         27,593      1,351,788        273,047.9  pthread_create        
      0.0        2,951,836         13        227,064.3        220,189.0         54,865        351,723         87,109.2  sem_timedwait         
      0.0        2,854,575         31         92,083.1         93,506.0         66,550        110,204         11,979.0  sleep                 
      0.0        2,512,181        116         21,656.7          6,228.5          1,036        744,957         96,508.8  mmap64                
      0.0          739,697          1        739,697.0        739,697.0        739,697        739,697              0.0  recv                  
      0.0          614,790        441          1,394.1          1,242.0          1,000         18,924          1,151.4  fstat64               
      0.0          512,673          1        512,673.0        512,673.0        512,673        512,673              0.0  fork                  
      0.0          386,395         48          8,049.9          3,894.0          1,046         39,566         10,465.8  pthread_cond_signal   
      0.0          325,971          1        325,971.0        325,971.0        325,971        325,971              0.0  posix_spawnp          
      0.0          321,207         34          9,447.3          6,644.5          6,329         30,022          6,903.1  fgets                 
      0.0          197,610         28          7,057.5          4,025.0          1,112         43,791          8,631.4  mmap                  
      0.0          169,122         48          3,523.4          2,069.0          1,000         18,043          3,947.1  fopen                 
      0.0          133,377         17          7,845.7          4,420.0          1,147         32,137          9,568.5  munmap                
      0.0          129,106          3         43,035.3          2,255.0          1,923        124,928         70,921.3  mprotect              
      0.0          122,967         48          2,561.8          1,388.0          1,003         18,315          3,396.1  lstat64               
      0.0           85,195         28          3,042.7          2,323.5          1,033         11,957          2,459.7  statx                 
      0.0           74,337         34          2,186.4          1,657.5          1,031         11,629          1,860.7  pthread_cond_broadcast
      0.0           72,184          3         24,061.3         24,990.0         16,317         30,877          7,324.3  waitpid               
      0.0           56,374         14          4,026.7          2,467.0          1,071         21,152          5,141.4  open                  
      0.0           47,151         16          2,946.9          2,387.5          1,008         12,614          2,835.8  fclose                
      0.0           35,804         21          1,705.0          1,460.0          1,133          3,283            656.4  pthread_mutex_trylock 
      0.0           33,320          8          4,165.0          2,464.0          1,177         16,685          5,161.5  fopen64               
      0.0           19,947          7          2,849.6          3,224.0          1,243          4,673          1,447.6  pipe2                 
      0.0           19,706          2          9,853.0          9,853.0          9,397         10,309            644.9  socketpair            
      0.0           14,809          5          2,961.8          2,503.0          1,979          5,210          1,301.0  flock                 
      0.0           14,338          2          7,169.0          7,169.0          5,795          8,543          1,943.1  socket                
      0.0           13,970          3          4,656.7          4,573.0          2,387          7,010          2,312.6  fread                 
      0.0           10,407          3          3,469.0          3,194.0          2,248          4,965          1,379.2  epoll_ctl             
      0.0            9,137          1          9,137.0          9,137.0          9,137          9,137              0.0  connect               
      0.0            8,285          3          2,761.7          1,295.0          1,259          5,731          2,571.6  openat64              
      0.0            5,686          4          1,421.5          1,414.5          1,237          1,620            195.1  sigaction             
      0.0            4,397          2          2,198.5          2,198.5          1,153          3,244          1,478.6  fwrite                
      0.0            2,474          2          1,237.0          1,237.0          1,099          1,375            195.2  fcntl                 
      0.0            2,361          1          2,361.0          2,361.0          2,361          2,361              0.0  bind                  
      0.0            1,853          1          1,853.0          1,853.0          1,853          1,853              0.0  getc                  
      0.0            1,797          1          1,797.0          1,797.0          1,797          1,797              0.0  pthread_mutex_lock    
      0.0            1,518          1          1,518.0          1,518.0          1,518          1,518              0.0  dup2                  
      0.0            1,380          1          1,380.0          1,380.0          1,380          1,380              0.0  listen                
      0.0            1,153          1          1,153.0          1,153.0          1,153          1,153              0.0  fflush                
      0.0            1,082          1          1,082.0          1,082.0          1,082          1,082              0.0  fcntl64               
      0.0            1,050          1          1,050.0          1,050.0          1,050          1,050              0.0  signal                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)    Max (ns)   StdDev (ns)                Name               
 --------  ---------------  ---------  -----------  -----------  ---------  ----------  -----------  ---------------------------------
     89.9      107,556,824        312    344,733.4      6,460.0      4,088  26,495,912  2,487,047.2  cudaLaunchKernel                 
      3.6        4,267,245          2  2,133,622.5  2,133,622.5  2,128,410   2,138,835      7,371.6  cudaGetDeviceProperties_v2_v12000
      2.9        3,446,876         39     88,381.4     57,867.0     37,687     179,836     47,494.2  cudaMalloc                       
      2.7        3,203,872        145     22,095.7      6,744.0      2,795     272,695     54,196.0  cudaMemcpyAsync                  
      0.3          302,499          4     75,624.8     91,325.0      8,381     111,468     45,838.2  cudaDeviceSynchronize            
      0.2          282,152         25     11,286.1      9,199.0      5,072      20,872      5,710.9  cudaStreamSynchronize            
      0.2          271,975      1,311        207.5        112.0         63      42,052      1,244.1  cuGetProcAddress_v2              
      0.1          112,034        119        941.5        340.0        198      31,678      2,931.3  cudaStreamIsCapturing_v10000     
      0.1           77,803          2     38,901.5     38,901.5        908      76,895     53,730.9  cuda479_v12060                   
      0.1           74,103          3     24,701.0     20,919.0     20,529      32,655      6,891.1  cudaLaunchKernelExC_v11060       
      0.0           46,414          1     46,414.0     46,414.0     46,414      46,414          0.0  cuda470_v12060                   
      0.0            7,436          4      1,859.0      1,877.0        889       2,793        826.5  cuInit                           
      0.0            3,688          2      1,844.0      1,844.0      1,643       2,045        284.3  cuKernelGetFunction              
      0.0            1,675          3        558.3         95.0         78       1,502        817.3  cuModuleGetLoadingMode           
      0.0            1,242          1      1,242.0      1,242.0      1,242       1,242          0.0  cuda473_v12060                   
      0.0              911          2        455.5        455.5        374         537        115.3  cuFuncGetName                    
      0.0              715          1        715.0        715.0        715         715          0.0  cuKernelGetAttribute             

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)   Med (ns)   Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  ---------  ---------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     18.2          456,954          3  152,318.0  152,382.0   150,750   153,822      1,537.0  kernel_cutlass_kernel_TiledMMA_ThrLayoutVMNK11110000_PermutationMNK____MMAAtom_ThrID10_ShapeMNK1281…
     17.9          450,361         16   28,147.6   28,319.5    10,688    45,888     16,987.3  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
     12.8          320,154         16   20,009.6   20,159.5     4,160    35,423     15,690.7  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      9.4          237,086         64    3,704.5    3,712.0     1,632     6,976      1,920.5  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      9.4          236,350         16   14,771.9   14,559.5     7,712    22,111      6,663.3  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      9.1          227,647         48    4,742.6    4,800.0     1,984     7,456      2,596.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      6.1          153,597         32    4,799.9    4,912.0     2,144     7,359      2,475.5  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      3.6           89,536         16    5,596.0    5,632.0     4,032     7,232      1,474.5  void at::native::unrolled_elementwise_kernel<at::native::float8_copy_kernel_cuda(at::TensorIterator…
      3.4           86,399         16    5,399.9    5,616.0     1,728     8,992      3,634.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<unsigned char, uns…
      3.2           80,480         16    5,030.0    5,200.0     2,176     7,744      2,608.0  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<unsigned int, (int)4, void …
      2.9           72,864         16    4,554.0    4,656.0     2,816     6,144      1,518.4  void at::native::vectorized_elementwise_kernel<(int)2, at::native::BUnaryFunctor<long, long, long, …
      2.3           56,895         48    1,185.3    1,216.0       832     1,504        195.3  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      1.7           42,048          8    5,256.0    5,296.0     4,800     5,568        221.5  void at::native::<unnamed>::distribution_elementwise_grid_stride_kernel<float, (int)4, void at::nat…

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  --------  --------  --------  --------  -----------  ------------------------------
     72.1          916,501     25  36,660.0   3,520.0       704   120,735     51,471.5  [CUDA memcpy Host-to-Device]  
     27.9          355,453    120   2,962.1   2,272.0     1,728     6,592      1,617.5  [CUDA memcpy Device-to-Device]

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
    434.430    120     3.620     0.969     0.057    14.680        5.590  [CUDA memcpy Device-to-Device]
     15.140     25     0.606     0.043     0.000     1.835        0.861  [CUDA memcpy Host-to-Device]  

Generated:
    /root/reference-kernels/problems/nvidia/nvfp4_group_gemm/profiles/submission_case0_nsys_20260208_220302.nsys-rep
    /root/reference-kernels/problems/nvidia/nvfp4_group_gemm/profiles/submission_case0_nsys_20260208_220302.sqlite
